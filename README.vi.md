<p align="right">
   <a href="./README.md">‰∏≠Êñá</a> | <a href="./README.en.md">English</a> | <strong>Ti·∫øng Vi·ªát</strong>
</p>
<div align="center">

![new-api](/web/public/logo.png)

# New API

üç• H·ªá th·ªëng Gateway M√¥ h√¨nh L·ªõn Th·∫ø h·ªá M·ªõi v√† Qu·∫£n l√Ω T√†i s·∫£n AI

<a href="https://trendshift.io/repositories/8227" target="_blank"><img src="https://trendshift.io/api/badge/repositories/8227" alt="Calcium-Ion%2Fnew-api | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>

<p align="center">
  <a href="https://raw.githubusercontent.com/Calcium-Ion/new-api/main/LICENSE">
    <img src="https://img.shields.io/github/license/Calcium-Ion/new-api?color=brightgreen" alt="license">
  </a>
  <a href="https://github.com/Calcium-Ion/new-api/releases/latest">
    <img src="https://img.shields.io/github/v/release/Calcium-Ion/new-api?color=brightgreen&include_prereleases" alt="release">
  </a>
  <a href="https://github.com/users/Calcium-Ion/packages/container/package/new-api">
    <img src="https://img.shields.io/badge/docker-ghcr.io-blue" alt="docker">
  </a>
  <a href="https://hub.docker.com/r/CalciumIon/new-api">
    <img src="https://img.shields.io/badge/docker-dockerHub-blue" alt="docker">
  </a>
  <a href="https://goreportcard.com/report/github.com/Calcium-Ion/new-api">
    <img src="https://goreportcard.com/badge/github.com/Calcium-Ion/new-api" alt="GoReportCard">
  </a>
</p>
</div>

## üìù M√¥ t·∫£ D·ª± √°n

> [!NOTE]  
> ƒê√¢y l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü ƒë∆∞·ª£c ph√°t tri·ªÉn d·ª±a tr√™n [One API](https://github.com/songquanpeng/one-api)

> [!IMPORTANT]  
> - D·ª± √°n n√†y ch·ªâ d√†nh cho m·ª•c ƒë√≠ch h·ªçc t·∫≠p c√° nh√¢n, kh√¥ng ƒë·∫£m b·∫£o t√≠nh ·ªïn ƒë·ªãnh v√† kh√¥ng cung c·∫•p h·ªó tr·ª£ k·ªπ thu·∫≠t.
> - Ng∆∞·ªùi d√πng ph·∫£i tu√¢n th·ªß [ƒêi·ªÅu kho·∫£n S·ª≠ d·ª•ng](https://openai.com/policies/terms-of-use) c·ªßa OpenAI v√† **c√°c quy ƒë·ªãnh ph√°p lu·∫≠t**, kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng cho m·ª•c ƒë√≠ch b·∫•t h·ª£p ph√°p.
> - Theo y√™u c·∫ßu c·ªßa [„ÄäBi·ªán ph√°p T·∫°m th·ªùi Qu·∫£n l√Ω D·ªãch v·ª• Tr√≠ tu·ªá Nh√¢n t·∫°o Sinh t·∫°o„Äã](http://www.cac.gov.cn/2023-07/13/c_1690898327029107.htm), vui l√≤ng kh√¥ng cung c·∫•p b·∫•t k·ª≥ d·ªãch v·ª• AI sinh t·∫°o n√†o ch∆∞a ƒë∆∞·ª£c ƒëƒÉng k√Ω cho c√¥ng ch√∫ng t·∫°i Trung Qu·ªëc.

<h2>ü§ù ƒê·ªëi t√°c Tin c·∫≠y</h2>
<p id="premium-sponsors">&nbsp;</p>
<p align="center"><strong>Kh√¥ng theo th·ª© t·ª± c·ª• th·ªÉ</strong></p>
<p align="center">
  <a href="https://www.cherry-ai.com/" target=_blank><img
    src="./docs/images/cherry-studio.png" alt="Cherry Studio" height="120"
  /></a>
  <a href="https://bda.pku.edu.cn/" target=_blank><img
    src="./docs/images/pku.png" alt="ƒê·∫°i h·ªçc B·∫Øc Kinh" height="120"
  /></a>
  <a href="https://www.compshare.cn/?ytag=GPU_yy_gh_newapi" target=_blank><img
    src="./docs/images/ucloud.png" alt="UCloud" height="120"
  /></a>
  <a href="https://www.aliyun.com/" target=_blank><img
    src="./docs/images/aliyun.png" alt="Alibaba Cloud" height="120"
  /></a>
  <a href="https://io.net/" target=_blank><img
    src="./docs/images/io-net.png" alt="IO.NET" height="120"
  /></a>
</p>
<p>&nbsp;</p>

## üìö T√†i li·ªáu

ƒê·ªÉ bi·∫øt t√†i li·ªáu chi ti·∫øt, vui l√≤ng truy c·∫≠p Wiki ch√≠nh th·ª©c c·ªßa ch√∫ng t√¥i: [https://docs.newapi.pro/](https://docs.newapi.pro/)

B·∫°n c≈©ng c√≥ th·ªÉ truy c·∫≠p DeepWiki do AI t·∫°o ra:
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/QuantumNous/new-api)

## ‚ú® T√≠nh nƒÉng Ch√≠nh

New API cung c·∫•p nhi·ªÅu t√≠nh nƒÉng phong ph√∫, vui l√≤ng tham kh·∫£o [Gi·ªõi thi·ªáu T√≠nh nƒÉng](https://docs.newapi.pro/wiki/features-introduction) ƒë·ªÉ bi·∫øt chi ti·∫øt:

1. üé® Giao di·ªán UI ho√†n to√†n m·ªõi
2. üåç H·ªó tr·ª£ ƒëa ng√¥n ng·ªØ
3. üí∞ Ch·ª©c nƒÉng n·∫°p ti·ªÅn tr·ª±c tuy·∫øn (YiPay)
4. üîç H·ªó tr·ª£ truy v·∫•n h·∫°n ng·∫°ch s·ª≠ d·ª•ng v·ªõi key (k·∫øt h·ª£p v·ªõi [neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool))
5. üîÑ T∆∞∆°ng th√≠ch v·ªõi c∆° s·ªü d·ªØ li·ªáu One API g·ªëc
6. üíµ H·ªó tr·ª£ t√≠nh ph√≠ theo l∆∞·ª£t s·ª≠ d·ª•ng m√¥ h√¨nh
7. ‚öñÔ∏è H·ªó tr·ª£ l·ª±a ch·ªçn k√™nh ng·∫´u nhi√™n c√≥ tr·ªçng s·ªë
8. üìà B·∫£ng ƒëi·ªÅu khi·ªÉn d·ªØ li·ªáu (console)
9. üîí Nh√≥m token v√† h·∫°n ch·∫ø m√¥ h√¨nh
10. ü§ñ H·ªó tr·ª£ nhi·ªÅu ph∆∞∆°ng th·ª©c ƒëƒÉng nh·∫≠p x√°c th·ª±c h∆°n (LinuxDO, Telegram, OIDC)
11. üîÑ H·ªó tr·ª£ m√¥ h√¨nh Rerank (Cohere v√† Jina), [T√†i li·ªáu API](https://docs.newapi.pro/api/jinaai-rerank)
12. ‚ö° H·ªó tr·ª£ OpenAI Realtime API (bao g·ªìm k√™nh Azure), [T√†i li·ªáu API](https://docs.newapi.pro/api/openai-realtime)
13. ‚ö° H·ªó tr·ª£ ƒë·ªãnh d·∫°ng Claude Messages, [T√†i li·ªáu API](https://docs.newapi.pro/api/anthropic-chat)
14. H·ªó tr·ª£ v√†o giao di·ªán chat qua route /chat2link
15. üß† H·ªó tr·ª£ thi·∫øt l·∫≠p reasoning effort th√¥ng qua h·∫≠u t·ªë t√™n m√¥ h√¨nh:
    1. M√¥ h√¨nh o-series c·ªßa OpenAI
        - Th√™m h·∫≠u t·ªë `-high` cho high reasoning effort (v√≠ d·ª•: `o3-mini-high`)
        - Th√™m h·∫≠u t·ªë `-medium` cho medium reasoning effort (v√≠ d·ª•: `o3-mini-medium`)
        - Th√™m h·∫≠u t·ªë `-low` cho low reasoning effort (v√≠ d·ª•: `o3-mini-low`)
    2. M√¥ h√¨nh thinking c·ªßa Claude
        - Th√™m h·∫≠u t·ªë `-thinking` ƒë·ªÉ b·∫≠t ch·∫ø ƒë·ªô thinking (v√≠ d·ª•: `claude-3-7-sonnet-20250219-thinking`)
16. üîÑ Ch·ª©c nƒÉng chuy·ªÉn ƒë·ªïi thinking-to-content
17. üîÑ Ch·ª©c nƒÉng gi·ªõi h·∫°n t·ªëc ƒë·ªô m√¥ h√¨nh cho ng∆∞·ªùi d√πng
18. üí∞ H·ªó tr·ª£ t√≠nh ph√≠ cache, khi b·∫≠t c√≥ th·ªÉ t√≠nh ph√≠ theo t·ª∑ l·ªá ƒë·∫∑t s·∫µn khi cache hit:
    1. Thi·∫øt l·∫≠p t√πy ch·ªçn `T·ª∑ l·ªá Cache Prompt` trong `C√†i ƒë·∫∑t H·ªá th·ªëng-C√†i ƒë·∫∑t V·∫≠n h√†nh`
    2. Thi·∫øt l·∫≠p `T·ª∑ l·ªá Cache Prompt` trong k√™nh, ph·∫°m vi 0-1, v√≠ d·ª• thi·∫øt l·∫≠p 0.5 c√≥ nghƒ©a l√† t√≠nh ph√≠ 50% khi cache hit
    3. C√°c k√™nh ƒë∆∞·ª£c h·ªó tr·ª£:
        - [x] OpenAI
        - [x] Azure
        - [x] DeepSeek
        - [x] Claude

## H·ªó tr·ª£ M√¥ h√¨nh

Phi√™n b·∫£n n√†y h·ªó tr·ª£ nhi·ªÅu m√¥ h√¨nh, vui l√≤ng tham kh·∫£o [T√†i li·ªáu API-Giao di·ªán Relay](https://docs.newapi.pro/api) ƒë·ªÉ bi·∫øt chi ti·∫øt:

1. M√¥ h√¨nh b√™n th·ª© ba **gpts** (gpt-4-gizmo-*)
2. Giao di·ªán k√™nh b√™n th·ª© ba [Midjourney-Proxy(Plus)](https://github.com/novicezk/midjourney-proxy), [T√†i li·ªáu API](https://docs.newapi.pro/api/midjourney-proxy-image)
3. Giao di·ªán k√™nh b√™n th·ª© ba [Suno API](https://github.com/Suno-API/Suno-API), [T√†i li·ªáu API](https://docs.newapi.pro/api/suno-music)
4. K√™nh t√πy ch·ªânh, h·ªó tr·ª£ nh·∫≠p ƒë·ªãa ch·ªâ g·ªçi ƒë·∫ßy ƒë·ªß
5. M√¥ h√¨nh Rerank ([Cohere](https://cohere.ai/) v√† [Jina](https://jina.ai/)), [T√†i li·ªáu API](https://docs.newapi.pro/api/jinaai-rerank)
6. ƒê·ªãnh d·∫°ng Claude Messages, [T√†i li·ªáu API](https://docs.newapi.pro/api/anthropic-chat)
7. Dify, hi·ªán t·∫°i ch·ªâ h·ªó tr·ª£ chatflow

## C·∫•u h√¨nh Bi·∫øn M√¥i tr∆∞·ªùng

ƒê·ªÉ bi·∫øt h∆∞·ªõng d·∫´n c·∫•u h√¨nh chi ti·∫øt, vui l√≤ng tham kh·∫£o [H∆∞·ªõng d·∫´n C√†i ƒë·∫∑t-C·∫•u h√¨nh Bi·∫øn M√¥i tr∆∞·ªùng](https://docs.newapi.pro/installation/environment-variables):

- `GENERATE_DEFAULT_TOKEN`: C√≥ t·∫°o token ban ƒë·∫ßu cho ng∆∞·ªùi d√πng m·ªõi ƒëƒÉng k√Ω hay kh√¥ng, m·∫∑c ƒë·ªãnh l√† `false`
- `STREAMING_TIMEOUT`: Th·ªùi gian ch·ªù ph·∫£n h·ªìi streaming, m·∫∑c ƒë·ªãnh 300 gi√¢y
- `DIFY_DEBUG`: K√™nh Dify c√≥ xu·∫•t th√¥ng tin workflow v√† node hay kh√¥ng, m·∫∑c ƒë·ªãnh `true`
- `FORCE_STREAM_OPTION`: C√≥ ghi ƒë√® tham s·ªë stream_options c·ªßa client hay kh√¥ng, m·∫∑c ƒë·ªãnh `true`
- `GET_MEDIA_TOKEN`: C√≥ th·ªëng k√™ token h√¨nh ·∫£nh hay kh√¥ng, m·∫∑c ƒë·ªãnh `true`
- `GET_MEDIA_TOKEN_NOT_STREAM`: C√≥ th·ªëng k√™ token h√¨nh ·∫£nh trong tr∆∞·ªùng h·ª£p kh√¥ng streaming hay kh√¥ng, m·∫∑c ƒë·ªãnh `true`
- `UPDATE_TASK`: C√≥ c·∫≠p nh·∫≠t t√°c v·ª• b·∫•t ƒë·ªìng b·ªô (Midjourney, Suno) hay kh√¥ng, m·∫∑c ƒë·ªãnh `true`
- `COHERE_SAFETY_SETTING`: C√†i ƒë·∫∑t an to√†n m√¥ h√¨nh Cohere, c√°c t√πy ch·ªçn l√† `NONE`, `CONTEXTUAL`, `STRICT`, m·∫∑c ƒë·ªãnh `NONE`
- `GEMINI_VISION_MAX_IMAGE_NUM`: S·ªë l∆∞·ª£ng h√¨nh ·∫£nh t·ªëi ƒëa cho m√¥ h√¨nh Gemini, m·∫∑c ƒë·ªãnh `16`
- `MAX_FILE_DOWNLOAD_MB`: K√≠ch th∆∞·ªõc t·∫£i xu·ªëng file t·ªëi ƒëa t√≠nh b·∫±ng MB, m·∫∑c ƒë·ªãnh `20`
- `CRYPTO_SECRET`: Kh√≥a m√£ h√≥a d√πng ƒë·ªÉ m√£ h√≥a n·ªôi dung c∆° s·ªü d·ªØ li·ªáu
- `AZURE_DEFAULT_API_VERSION`: Phi√™n b·∫£n API m·∫∑c ƒë·ªãnh k√™nh Azure, m·∫∑c ƒë·ªãnh `2025-04-01-preview`
- `NOTIFICATION_LIMIT_DURATION_MINUTE`: Th·ªùi gian gi·ªõi h·∫°n th√¥ng b√°o, m·∫∑c ƒë·ªãnh `10` ph√∫t
- `NOTIFY_LIMIT_COUNT`: S·ªë l∆∞·ª£ng th√¥ng b√°o t·ªëi ƒëa c·ªßa ng∆∞·ªùi d√πng trong kho·∫£ng th·ªùi gian ch·ªâ ƒë·ªãnh, m·∫∑c ƒë·ªãnh `2`
- `ERROR_LOG_ENABLED=true`: C√≥ ghi l·∫°i v√† hi·ªÉn th·ªã log l·ªói hay kh√¥ng, m·∫∑c ƒë·ªãnh `false`

## Tri·ªÉn khai

ƒê·ªÉ bi·∫øt h∆∞·ªõng d·∫´n tri·ªÉn khai chi ti·∫øt, vui l√≤ng tham kh·∫£o [H∆∞·ªõng d·∫´n C√†i ƒë·∫∑t-Ph∆∞∆°ng th·ª©c Tri·ªÉn khai](https://docs.newapi.pro/installation):

> [!TIP]
> Docker image m·ªõi nh·∫•t: `calciumion/new-api:latest`

### L∆∞u √Ω Tri·ªÉn khai ƒêa m√°y
- Ph·∫£i thi·∫øt l·∫≠p bi·∫øn m√¥i tr∆∞·ªùng `SESSION_SECRET`, n·∫øu kh√¥ng s·∫Ω d·∫´n ƒë·∫øn tr·∫°ng th√°i ƒëƒÉng nh·∫≠p kh√¥ng nh·∫•t qu√°n khi tri·ªÉn khai ƒëa m√°y
- N·∫øu d√πng chung Redis, ph·∫£i thi·∫øt l·∫≠p `CRYPTO_SECRET`, n·∫øu kh√¥ng s·∫Ω d·∫´n ƒë·∫øn kh√¥ng th·ªÉ l·∫•y n·ªôi dung Redis khi tri·ªÉn khai ƒëa m√°y

### Y√™u c·∫ßu Tri·ªÉn khai
- C∆° s·ªü d·ªØ li·ªáu c·ª•c b·ªô (m·∫∑c ƒë·ªãnh): SQLite (tri·ªÉn khai Docker ph·∫£i mount th∆∞ m·ª•c `/data`)
- C∆° s·ªü d·ªØ li·ªáu t·ª´ xa: MySQL phi√™n b·∫£n >= 5.7.8, PgSQL phi√™n b·∫£n >= 9.6

### Ph∆∞∆°ng th·ª©c Tri·ªÉn khai

#### S·ª≠ d·ª•ng T√≠nh nƒÉng Docker c·ªßa Panel BaoTa
C√†i ƒë·∫∑t Panel BaoTa (phi√™n b·∫£n **9.2.0** tr·ªü l√™n), t√¨m **New-API** trong c·ª≠a h√†ng ·ª©ng d·ª•ng v√† c√†i ƒë·∫∑t.
[H∆∞·ªõng d·∫´n c√≥ h√¨nh ·∫£nh](./docs/BT.md)

#### S·ª≠ d·ª•ng Docker Compose (Khuy·∫øn ngh·ªã)
```shell
# T·∫£i d·ª± √°n
git clone https://github.com/Calcium-Ion/new-api.git
cd new-api
# Ch·ªânh s·ª≠a docker-compose.yml theo nhu c·∫ßu
# Kh·ªüi ƒë·ªông
docker-compose up -d
```

#### S·ª≠ d·ª•ng Docker Image Tr·ª±c ti·∫øp
```shell
# S·ª≠ d·ª•ng SQLite
docker run --name new-api -d --restart always -p 3000:3000 -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest

# S·ª≠ d·ª•ng MySQL
docker run --name new-api -d --restart always -p 3000:3000 -e SQL_DSN="root:123456@tcp(localhost:3306)/oneapi" -e TZ=Asia/Shanghai -v /home/ubuntu/data/new-api:/data calciumion/new-api:latest
```

## Retry K√™nh v√† Cache
Ch·ª©c nƒÉng retry k√™nh ƒë√£ ƒë∆∞·ª£c tri·ªÉn khai, b·∫°n c√≥ th·ªÉ thi·∫øt l·∫≠p s·ªë l·∫ßn retry trong `C√†i ƒë·∫∑t->C√†i ƒë·∫∑t V·∫≠n h√†nh->C√†i ƒë·∫∑t Chung`, **khuy·∫øn ngh·ªã b·∫≠t** ch·ª©c nƒÉng cache.

### Ph∆∞∆°ng ph√°p C√†i ƒë·∫∑t Cache
1. `REDIS_CONN_STRING`: Thi·∫øt l·∫≠p Redis l√†m cache
2. `MEMORY_CACHE_ENABLED`: B·∫≠t memory cache (kh√¥ng c·∫ßn thi·∫øt l·∫≠p th·ªß c√¥ng n·∫øu ƒë√£ thi·∫øt l·∫≠p Redis)

## T√†i li·ªáu API

ƒê·ªÉ bi·∫øt t√†i li·ªáu API chi ti·∫øt, vui l√≤ng tham kh·∫£o [T√†i li·ªáu API](https://docs.newapi.pro/api):

- [API Chat](https://docs.newapi.pro/api/openai-chat)
- [API H√¨nh ·∫£nh](https://docs.newapi.pro/api/openai-image)
- [API Rerank](https://docs.newapi.pro/api/jinaai-rerank)
- [API Realtime](https://docs.newapi.pro/api/openai-realtime)
- [API Chat Claude (messages)](https://docs.newapi.pro/api/anthropic-chat)

## C√°c D·ª± √°n Li√™n quan
- [One API](https://github.com/songquanpeng/one-api): D·ª± √°n g·ªëc
- [Midjourney-Proxy](https://github.com/novicezk/midjourney-proxy): H·ªó tr·ª£ giao di·ªán Midjourney
- [chatnio](https://github.com/Deeptrain-Community/chatnio): Gi·∫£i ph√°p m·ªôt c·ª≠a AI th·∫ø h·ªá ti·∫øp theo cho B/C-end
- [neko-api-key-tool](https://github.com/Calcium-Ion/neko-api-key-tool): Truy v·∫•n h·∫°n ng·∫°ch s·ª≠ d·ª•ng v·ªõi key

C√°c d·ª± √°n kh√°c d·ª±a tr√™n New API:
- [new-api-horizon](https://github.com/Calcium-Ion/new-api-horizon): Phi√™n b·∫£n t·ªëi ∆∞u hi·ªáu su·∫•t cao c·ªßa New API
- [VoAPI](https://github.com/VoAPI/VoAPI): Phi√™n b·∫£n frontend ƒë·∫πp m·∫Øt d·ª±a tr√™n New API

## Tr·ª£ gi√∫p v√† H·ªó tr·ª£

N·∫øu c√≥ c√¢u h·ªèi, vui l√≤ng tham kh·∫£o [Tr·ª£ gi√∫p v√† H·ªó tr·ª£](https://docs.newapi.pro/support):
- [T∆∞∆°ng t√°c C·ªông ƒë·ªìng](https://docs.newapi.pro/support/community-interaction)
- [Ph·∫£n h·ªìi V·∫•n ƒë·ªÅ](https://docs.newapi.pro/support/feedback-issues)
- [C√¢u h·ªèi Th∆∞·ªùng g·∫∑p](https://docs.newapi.pro/support/faq)

## üåü L·ªãch s·ª≠ Star

[![Star History Chart](https://api.star-history.com/svg?repos=Calcium-Ion/new-api&type=Date)](https://star-history.com/#Calcium-Ion/new-api&Date)